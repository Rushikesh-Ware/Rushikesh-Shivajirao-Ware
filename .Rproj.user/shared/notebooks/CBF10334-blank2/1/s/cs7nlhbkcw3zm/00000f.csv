"0","data_2021 <- Co2_emission %>%"
"0","  filter(Year == 2021) %>%"
"0","  replace(is.na(.), 0) %>%"
"0","  arrange(desc(Total)) %>%"
"0","  head(7)"
"0",""
"0","data_melted <- melt(data_2021, id.vars = c(""Country"", ""ISO.3166.1.alpha.3"", ""Year"", ""Total""), "
"0","                    variable.name = ""Fuel_Type"", value.name = ""Emissions"")"
"0",""
"0","data_melted <- data_melted %>%"
"0","  group_by(Country) %>%"
"0","  mutate(Percentage = Emissions / sum(Emissions) * 100)"
"0",""
"0","percentage_plot <- plot_ly(data = data_melted, x = ~Country, y = ~Percentage, type = 'bar', color = ~Fuel_Type,"
"0","                           text = ~paste0(round(Percentage, 1), ""%""), textposition = 'auto',"
"0","                           hoverinfo = 'text+x+y') %>%"
"0","  layout(title = ""Percentage of Emissions by Fuel Type in Top 7 Countries (2021)"", "
"0","         xaxis = list(title = ""Country""), "
"0","         yaxis = list(title = ""Percentage (%)""),"
"0","         barmode = 'stack')"
"0",""
"0","percentage_plot"
